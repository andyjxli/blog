{"componentChunkName":"component---src-templates-article-tsx","path":"/network/网络层/","result":{"pageContext":{"html":"<blockquote>\n<p>本文仅作为阅读笔记</p>\n</blockquote>\n<h3>虚电路服务与数据报服务</h3>\n<p><code class=\"language-text\">虚电路服务</code>是借鉴电信网成功的基础上提出的。为了保证可靠的交付，在计算机相互通信之前，需要建立虚拟链接，在通信完成后释放链接。这种链路保证了数据传输的可靠性，同时每条数据都是按照顺序传递到终点。</p>\n<p>这种链路虽然保证了数据传输的可靠性，但是效率却不是那么高，所以提出了<code class=\"language-text\">数据报服务</code>。数据报服务使得 <strong>网络层向上只提供简单灵活的、无连接的、尽最大努力交付的服务</strong>。每个分组并不按照规定顺序进行发送，而是自由的选择路由进行转发，到达时间也不相同。</p>\n<h3>网际协议 IP</h3>\n<p>网际协议 IP 是 TCP/IP 体系中最主要的协议之一。与其配套的还有三个协议：</p>\n<ol>\n<li>地址解析协议 ARP （Address Resolution Protocol）</li>\n<li>网际控制报文协议 ICMP （Internet Control Message Protocol）</li>\n<li>网际组管理协议 ICMP （Internet Group Management Protocol）</li>\n</ol>\n<h4>虚拟互联网络</h4>\n<p>在现实生活中，为了满足不同的需求，网络实现的结构之间的差异是非常大的，例如有不同的差错控制方式、不同的长度限制、不同的寻址方案等等。为了使得这些异构网络能够相互连接，使用了一些中间设备：</p>\n<ol>\n<li>物理层为转发器</li>\n<li>数据链路层为网桥</li>\n<li>网络层为路由器</li>\n<li>更上层为网关</li>\n</ol>\n<p>通过这些中间设备，能够让不同的网络之间看起来没有差异，从而每个用户都能进行交流。</p>\n<h4>分类的 IP 地址</h4>\n<p>IP 地址是由 4 个字节（32）位组成的。主要组成部分分为网络号和主机号。例如：173.24.43.168</p>\n<p>IP 地址 ::= { &#x3C;网络号>, &#x3C;主机号> }</p>\n<p>为什么要进行分类？</p>\n<p>为了满足不同用户之间的需求，有的网络可能需要链接很多的主机，而有的网络只需要链接很少的主机。所以进行分类。</p>\n<h5>分类</h5>\n<p>A 类地址：A 类地址的网络号字段占一个字节，所以可用的个数为 2^7 个（还要留给其他分类字段）。但 0.0.0.0 指代本网络，127 网络段用于本地测试。所以总共有 2^7 - 2 个网络段。</p>\n<p>B 类地址：B 类地址的网络号字段占两个字节，从 128.0.0.0 开始，用二进制表示网络段为 10000000.00000000.00000000.00000000，前两位固定了，所以总共有 2^14 个可使用，但是由于 128.0.0.0 不可指派，实际上是 2^14 - 1 个。</p>\n<p>C 类地址：C 类地址的网络号字段占三个字节，从 192 位开始，也就是 11000000，同样的计算方式，前三位 110 固定了，共有 2^21 个网络号，但 192.0.0.0 不可指派，实际上是 2^21 - 1 个。</p>\n<p>D 类地址：前四位为 1110，用于多播</p>\n<p>E 类地址：前四位为 1111，保留网段</p>\n<h5>IP 地址的特点</h5>\n<ol>\n<li>将 IP 地址分类，由网络地址管理机构进行网络号的分配，而主机号由企业或机构自己分配。同时数据在分组转发时可以通过网络号来进行转发到该网络段内，再由路由器进行转发到目的主机。</li>\n<li>在同一个网络段内，既使是多个局域网，也会被称为一个网络。所以在链路层使用网桥互联的局域网也是同一个网络。</li>\n<li>当一个主机连接多个网络时，它应被分为两个 IP 地址。</li>\n<li>在同一个网段中的 IP 地址都是被平等对待的。</li>\n</ol>\n<h4>IP 地址与 MAC 地址</h4>\n<p>IP 地址是网络层和以上各层使用的逻辑地址。 MAC 地址使用在物理层和数据链路层，具体查看 <a href=\"https://juejin.im/post/5ead6c416fb9a0434a2e56d2\">数据链路层</a>。</p>\n<ol>\n<li>在 IP 层抽象的互联网上只能看到 IP 数据报</li>\n<li>路由器指根据目的站的 IP 地址的网络号进行路由选择</li>\n<li>在局域网的链路层，只能看见 MAC 帧。</li>\n<li>IP 层抽象的互联网屏蔽了硬件地址体系的细节，使得我们在网络层上讨论问题，就能够使用统一的、抽象的 IP 地址研究主机或主机与路由器之间的通信。</li>\n</ol>\n<p>为什么有了 MAC 地址还需要 IP 地址？</p>\n<p>世界上有很多的异构网络，他们使用者不同的 MAC 地址体系，在寻址时需要进行复杂的 MAC 地址转换。通过抽象出 IP 层地址，可以很好的避免问题。</p>\n<h4>地址解析协议 ARP</h4>\n<p>在网络传输中，路由器是通过 ARP 协议进行寻址的。</p>\n<p>当一个主机需要发送数据到另一个主机时，该主机在 <code class=\"language-text\">ARP 高速缓存</code> 中去查找需要转发的硬件地址。<code class=\"language-text\">ARP 高速缓存</code> 缓存了本局域网的主机和路由器的 MAC 地址与 IP 地址的映射表。如果找到了则直接通过局域网转发到该 MAC 地址。如果未找到则进行以下几个步骤：</p>\n<ol>\n<li>APR 进程在本局域网中发送 APR 分组请求</li>\n<li>局域网中所有主机运行的 ARP 都会接收到其发送的请求分组。</li>\n<li>如果某台主机匹配到了请求分组中的 IP 地址，则会进行响应。将其 MAC 返回回去。</li>\n<li>要发送数据的主机接收到响应后 ARP 会将其缓存下来。</li>\n</ol>\n<p>高速缓存是由时效控制的，因为 IP 地址可能是动态的，某台主机可能更换了 IP 地址。</p>","frontmatter":{"title":"网络层","path":null,"date":"2020-06-06T00:00:00.000Z","tags":["OSI","网络层"],"layout":"post","image":null,"author":"xilizi","category":{"title":"计算机网络","name":"network"}}}}}